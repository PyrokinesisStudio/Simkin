<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>skInterpreterp.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.1 on Fri Jun 22 11:10:42 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>skInterpreterp.h</h1><div class="fragment"><pre>00001 
00008 <font class="preprocessor">#include "skParseNode.h"</font>
00009 
00010 <font class="preprocessor">#include "skHashTable.h"</font>
00011 <font class="preprocessor">#include "skExecutableIterator.h"</font>
00012 
<a name="l00013"></a><a class="code" href="class_skRValueTable.html">00013</a> <font class="keyword">class </font><a class="code" href="class_skRValueTable.html">skRValueTable</a>: <font class="keyword">public</font> <a class="code" href="class_skTHashTable.html">skTHashTable</a>&lt;skString,skRValue&gt;
00014 {
00015  <font class="keyword">public</font>:
00016     skRValueTable(<font class="keywordtype">unsigned</font> <font class="keywordtype">short</font>  size);
00017     skRValueTable();
00018     ~skRValueTable();
00019 
00020 };
00021 
00022 <font class="keyword">const</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> MAX_LOCAL_VARS_CACHE=5;
00023 
00024 
00025 <font class="keyword">class </font>P_Interpreter 
00026 {   
00027  <font class="keyword">public</font>:
00028     P_Interpreter();
00029     ~P_Interpreter();
00030                                                 
00031 
00032     <font class="comment">// Expression evaluation</font>
00033   
00034     <a class="code" href="class_skRValue.html">skRValue</a> evaluate(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skExprNode * n);
00035     <a class="code" href="class_skRValue.html">skRValue</a> evalMethod(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skIdListNode * ids);
00036     <font class="keywordtype">void</font> makeMethodCall(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<a class="code" href="class_skRValue.html">skRValue</a>&amp; robject,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; method_name,skExprNode * array_index, <font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attribute,skExprListNode * exprs,<a class="code" href="class_skRValue.html">skRValue</a>&amp; ret);
00037 
00038     <font class="comment">// Statement execution</font>
00039 
00040     <font class="keywordtype">void</font> executeAssignStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skAssignNode * n);
00041 
00042     <font class="comment">// the statements below return true to halt further processing (i.e. a return statement has been encountered)</font>
00043 
00044     <font class="keywordtype">bool</font> executeStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skStatNode * pstat,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00045     <font class="keywordtype">bool</font> executeStats(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skStatListNode * n,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00046     <font class="keywordtype">bool</font> executeReturnStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skReturnNode * n,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00047     <font class="keywordtype">bool</font> executeIfStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skIfNode * n,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00048     <font class="keywordtype">bool</font> executeWhileStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skWhileNode * n,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00049     <font class="keywordtype">bool</font> executeSwitchStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skSwitchNode * n,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00050     <font class="keywordtype">bool</font> executeForEachStat(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skForEachNode * n,<a class="code" href="class_skRValue.html">skRValue</a>&amp; r);
00051 
00052     <font class="comment">// Misc runtime routines</font>
00053 
00054     <font class="keywordtype">void</font> addLocalVariable(<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; name,<a class="code" href="class_skRValue.html">skRValue</a> value); <font class="comment">// adds a local variable to the current list</font>
00055     <a class="code" href="class_skString.html">skString</a> checkIndirectId(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; name); <font class="comment">// checks whether a field name includes the indirection character</font>
00056     <font class="comment">// tries to find a the value of the named variable</font>
00057     <a class="code" href="class_skRValue.html">skRValue</a> findValue(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; name,skExprNode * array_index,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attribute); 
00058     <font class="keywordtype">void</font> runtimeError(<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; s); <font class="comment">// creates and throws a skRuntimeException</font>
00059     <font class="keywordtype">void</font> followIdList(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,skIdListNode * idList,<a class="code" href="class_skRValue.html">skRValue</a>&amp; object); <font class="comment">// follows a dotted list of id's</font>
00060 
00061     <font class="comment">// extracts a value of the form foo[1] - first dereferencing foo</font>
00062     <font class="keywordtype">bool</font> extractFieldArrayValue(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<a class="code" href="class_skRValue.html">skRValue</a>&amp; robject,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; field_name,skExprNode * array_index,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attrib,<a class="code" href="class_skRValue.html">skRValue</a>&amp; ret);
00063     <font class="comment">// extracts a value of the form robject[1] - assumes robject is already a collection object</font>
00064     <font class="keywordtype">bool</font> extractArrayValue(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<a class="code" href="class_skRValue.html">skRValue</a>&amp; robject,skExprNode * array_index,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attrib,<a class="code" href="class_skRValue.html">skRValue</a>&amp; ret) ;
00065     <font class="comment">// extracts an instance variable with the given name</font>
00066     <font class="keywordtype">bool</font> extractValue(<a class="code" href="class_skRValue.html">skRValue</a>&amp; robject,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; name,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attrib,<a class="code" href="class_skRValue.html">skRValue</a>&amp; ret) ;
00067     
00068     <font class="comment">// wrapper around setValueAt</font>
00069     <font class="keywordtype">bool</font> insertArrayValue(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<a class="code" href="class_skRValue.html">skRValue</a>&amp; robject, skExprNode * array_index,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attr,<font class="keyword">const</font> <a class="code" href="class_skRValue.html">skRValue</a>&amp; value);
00070     <font class="comment">// wrapper around setValue</font>
00071     <font class="keywordtype">bool</font> insertValue(<a class="code" href="class_skRValue.html">skRValue</a>&amp; robject,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; name, <font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; attr,<font class="keyword">const</font> <a class="code" href="class_skRValue.html">skRValue</a>&amp; value);
00072 
00073     <font class="comment">// Variables</font>
00074     <a class="code" href="class_skRValueTable.html">skRValueTable</a> m_GlobalVars; <font class="comment">// the global variables</font>
00075     <a class="code" href="class_skRValueTable.html">skRValueTable</a> m_LocalVars[MAX_LOCAL_VARS_CACHE]; <font class="comment">// a pool of local variable tables</font>
00076     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> m_StackDepth; <font class="comment">// the current stack depth</font>
00077     <font class="keywordtype">bool</font> m_Tracing; <font class="comment">// flag for tracing method calls</font>
00078 
00079     <a class="code" href="class_skString.html">skString</a> m_Location; <font class="comment">// location during script execution</font>
00080     <font class="keywordtype">int</font> m_LineNum; <font class="comment">// line number during script execution</font>
00081     THREAD <font class="keyword">static</font> <a class="code" href="class_skInterpreter.html">skInterpreter</a> * g_GlobalInterpreter;  <font class="comment">//      used by clients - one per thread (on Windows only at the moment)</font>
00082 
00083 };    
00084 
00085 <font class="comment">//---------------------------------------------------</font>
00086 <font class="keyword">inline</font> <a class="code" href="class_skString.html">skString</a> P_Interpreter::checkIndirectId(<a class="code" href="class_skExecutable.html">skExecutable</a> * obj,<a class="code" href="class_skRValueTable.html">skRValueTable</a>&amp; var,<font class="keyword">const</font> <a class="code" href="class_skString.html">skString</a>&amp; name)
00087 <font class="comment">//---------------------------------------------------</font>
00088 {
00089   <font class="comment">// look for an initial "@" in a field name, and de-reference it if necessary</font>
00090     <a class="code" href="class_skString.html">skString</a> ret=name;
00091     <font class="keywordflow">if</font> (name.at(0)==<font class="charliteral">'@'</font>){
00092         ret=name.substr(1,name.length()-1);
00093         <a class="code" href="class_skRValue.html">skRValue</a> new_name=findValue(obj,var,ret,0,skString());
00094         ret=new_name.<a class="code" href="class_skRValue.html#a16">str</a>();
00095     }
00096     <font class="keywordflow">return</font> ret;
00097 }       
</div></pre><hr><address><small>Generated at Fri Jun 22 11:10:42 2001 for Simkin by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
